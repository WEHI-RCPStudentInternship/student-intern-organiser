{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block page_title %}Dashboard{% endblock %}

{% block top_links_menu %}

        <a href="/dashboard/new_all">New All Intake Dashboard</a>
        <a href="/dashboard/new_signed">New Signed Intake Dashboard</a>
        <a href="/dashboard/new_signed_and_accepted">New Signed and Accepted Intake Dashboard</a>
        <a href="/dashboard/new_signed_and_offered">New Signed and Offered Intake Dashboard</a>
        <a href="/dashboard/current">Current Intake Dashboard</a>
        <a href="/dashboard/finished">Finished Intake Dashboard</a>

{% endblock %}

{% block content %}
<style>
    table {
        border-collapse: collapse;
        width: 100%;
    }
    
    th, td {
        border: 1px solid #ccc;
        padding: 5px;
    }
    
    th {
        background-color: #f2f2f2;
    }
    
    caption {
        font-weight: bold;
        font-size: 1.2em;
        margin-bottom: 10px;
    }
</style>

<div style="display: flex; flex-wrap: wrap;">
    <div style="flex: 1; margin-right: 20px;">
        <table>
            <caption style="color: #3173ee;">Breakdown by Value</caption>
            <tr>
                <th>Value of signed-up and previous students</th>
                <th>Count</th>
                <th>Equivalent</th>
            </tr>

            {% set ns = namespace() %}
            {% set ns.total_equiv = 0 %}
            {% set ns.total_count = 0 %}
            {% for value, count in breakdown_courses.items() %}
            <tr>
                <td>{{ value }}</td>
                <td>{{ count }}</td>
                {% set ns.total_count = ns.total_count + count  %}
                
                {% if value == "Engineering and IT"%}
                    {% set ns.total_equiv = ns.total_equiv + (count * 9000)  %}
                    <td>{{ count * 9000 }} {{ total_equiv }}</td>
                {% elif value == "Science Full Year" %}
                    {% set ns.total_equiv = ns.total_equiv + (count * 6000)  %}
                    <td>{{ count * 6000 }} {{ total_equiv }} </td>
                {% else %}
                    {% set ns.total_equiv = ns.total_equiv + (count * 3000)  %}
                    <td>{{ count * 3000 }}</td>
                {% endif %}
            </tr>
            {% endfor %}
            <tr>
                <td></td>
                <td>{{ ns.total_count }}</td>
                <td>{{ ns.total_equiv }}</td>
            </tr>
        </table>
    </div>
    
    <div style="flex: 1; margin-right: 20px;">
        <table>
            <caption style="color: #3173ee;">Breakdown by Ratings</caption>
            <tr>
                <th>Value</th>
                <th>Count</th>
                <th>%</th>
            </tr>
            {% for value, count in breakdown_ratings.items() %}
            <tr>
                <td>{{ value }}</td>
                <td>{{ count }}</td>
                <td>{{ (count/total_students_current_and_past*100)|round(2) }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    
    <div style="flex: 1;">
        <table>
            <caption style="color: #3173ee;"> Breakdown by Pronouns</caption>
            <tr>
                <th>Pronouns</th>
                <th>Count</th>
                <th>%</th>
            </tr>
            {% for pronouns, data in pronoun_data.items() %}
            <tr>
                <td>{{ pronouns }}</td>
                <td>{{ data['count'] }}</td>
                <td>{{ pronoun_percentage[pronouns] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>
{% endblock %}
